<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>注册 - 碳森林</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- 自定义样式 -->
    <link rel="stylesheet" href="../assets/css/style.css">
</head>
<body>
    <div class="auth-container">
        <div class="auth-card">
            <div class="auth-title">
                <h2>注册碳森林账户</h2>
                <p>加入我们，一起为地球减碳</p>
            </div>
            
            <form id="registerForm" class="auth-form">
                <div class="form-group">
                    <label for="username" class="form-label">用户名</label>
                    <input type="text" id="username" class="form-control" placeholder="请输入用户名（4-20位字母、数字、下划线）" required>
                    <small class="form-text text-muted">用户名要求：4-20位，只能包含字母、数字和下划线</small>
                    <div class="invalid-feedback">用户名格式不正确</div>
                </div>
                
                <div class="form-group">
                    <label for="email" class="form-label">邮箱</label>
                    <input type="email" id="email" class="form-control" placeholder="请输入邮箱" required>
                    <div class="invalid-feedback">请输入有效的邮箱地址</div>
                </div>
                
                <div class="form-group">
                    <label for="password" class="form-label">密码</label>
                    <input type="password" id="password" class="form-control" placeholder="请输入密码（不少于8位，包含大小写字母和数字）" required>
                    <small class="form-text text-muted">密码要求：不少于8位，必须包含大小写字母和数字</small>
                    <div class="invalid-feedback">密码强度不足</div>
                </div>
                
                <div class="form-group">
                    <label for="confirmPassword" class="form-label">确认密码</label>
                    <input type="password" id="confirmPassword" class="form-control" placeholder="请再次输入密码" required>
                    <div class="invalid-feedback">两次输入的密码不一致</div>
                </div>
                
                <div class="form-group">
                    <label for="userType" class="form-label">用户类型</label>
                    <select id="userType" class="form-control" required>
                        <option value="personal">个人</option>
                        <option value="enterprise">企业</option>
                        <option value="institution">事业单位</option>
                    </select>
                    <div class="invalid-feedback">请选择用户类型</div>
                </div>
                
                <div class="form-group">
                    <label for="carrierType" class="form-label">选择您的虚拟载体</label>
                    <div class="d-flex gap-3">
                        <div class="carrier-option">
                            <input type="radio" id="carrierTree" name="carrierType" value="tree" class="d-none" checked>
                            <label for="carrierTree" class="d-block text-center p-3 border rounded cursor-pointer hover:bg-green-50 transition-all">
                                <div class="w-20 h-20 mx-auto mb-2 bg-green-200 rounded-full flex items-center justify-center">
                                    <i class="fa fa-tree text-green-600 text-2xl"></i>
                                </div>
                                <span>碳汇树</span>
                            </label>
                        </div>
                        <div class="carrier-option">
                            <input type="radio" id="carrierPagoda" name="carrierType" value="pagoda" class="d-none">
                            <label for="carrierPagoda" class="d-block text-center p-3 border rounded cursor-pointer hover:bg-green-50 transition-all">
                                <div class="w-20 h-20 mx-auto mb-2 bg-blue-200 rounded-full flex items-center justify-center">
                                    <i class="fa fa-building text-blue-600 text-2xl"></i>
                                </div>
                                <span>双碳宝塔</span>
                            </label>
                        </div>
                    </div>
                </div>
                
                <button type="submit" class="btn auth-btn">注册</button>
            </form>
            
            <div class="auth-switch">
                <p>已有账户？<a href="login.html">立即登录</a></p>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- 自定义JS -->
    <script src="../assets/js/main.js"></script>
    
    <!-- 确保页面完全加载后执行初始化 -->
    <script>
        // 确保DOM完全加载后检查初始化状态
        document.addEventListener('DOMContentLoaded', function() {
            console.log('页面加载完成，开始初始化注册页面');
            
            // 检查表单元素是否存在
            const form = document.getElementById('registerForm');
            const username = document.getElementById('username');
            const email = document.getElementById('email');
            const password = document.getElementById('password');
            const confirmPassword = document.getElementById('confirmPassword');
            const userType = document.getElementById('userType');
            
            console.log('表单元素检查:', {
                form: !!form,
                username: !!username,
                email: !!email,
                password: !!password,
                confirmPassword: !!confirmPassword,
                userType: !!userType
            });
            
            if (form && username && email && password && confirmPassword && userType) {
                console.log('所有表单元素已正确加载');
            } else {
                console.error('部分表单元素未找到，请检查HTML结构');
            }
        });
        
        // 注册表单验证
        document.getElementById('registerForm').addEventListener('submit', function(e) {
            let isValid = true;
            
            // 清除之前的错误状态
            document.querySelectorAll('.form-control').forEach(input => {
                input.classList.remove('is-invalid');
            });
            
            // 验证用户名：4-20位字母、数字、下划线
            const username = document.getElementById('username');
            const usernameRegex = /^[a-zA-Z0-9_]{4,20}$/;
            if (!usernameRegex.test(username.value)) {
                username.classList.add('is-invalid');
                isValid = false;
            }
            
            // 验证邮箱格式
            const email = document.getElementById('email');
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email.value)) {
                email.classList.add('is-invalid');
                isValid = false;
            }
            
            // 验证密码：不少于8位，包含大小写字母和数字
            const password = document.getElementById('password');
            const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/;
            if (!passwordRegex.test(password.value)) {
                password.classList.add('is-invalid');
                isValid = false;
            }
            
            // 验证密码一致性
            const confirmPassword = document.getElementById('confirmPassword');
            if (confirmPassword.value !== password.value) {
                confirmPassword.classList.add('is-invalid');
                isValid = false;
            }
            
            // 验证用户类型
            const userType = document.getElementById('userType');
            if (!userType.value) {
                userType.classList.add('is-invalid');
                isValid = false;
            }
            
            if (!isValid) {
                e.preventDefault();
            }
        });
    </script>
</body>
</html>